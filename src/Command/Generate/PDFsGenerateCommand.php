<?php

namespace App\Command\Generate;

use Illuminate\Support\Str;
use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;

class PDFsGenerateCommand extends Command
{
    protected static $defaultName = 'generate:pdfs';

    protected function configure(): void
    {
        $this->setDescription('Generate pdf file of text');
    }

    protected function execute(InputInterface $input, OutputInterface $output): int
    {
        $modules = [
            "Что такое бизнес",
            "Какие риски",
            "О идее",
            "Цели SMART",
            "Анализ возможностей",
            "Анализ членов команды",
            "Что такое проект",
            "Жизненный цикл компании",
            "Советы",
            "Рынок производства",
            "Рынок услуги",
            "Сегментирование рынка",
            "Маркетинг",
            "Оценка конкурентоспособности",
            "Оценка привлекательности ценовых сегментов",
            "Информации первичные, вторичные",
            "Что такое B2B, B2C",
            "SWOT анализ",
            "Метод 1000х1000 Матрица Маккинзи",
            "Мониторинг",
            "Риски",
            "3 главных вопроса",
            "Стратегия ценообразования",
            "Технология разработки сбытовой сети",
            "Медиа-план",
            "Коммуникационная политика",
            "Каналы продвижения",
            "4Р маркетинга",
            "Нужда/потребность",
            "Позиционирование продукта",
            "Процесс разработки нового товара",
            "АВС анализ",
            "Ассортимент товара",
            "Принципы маркетинга",
            "Функции маркетинга",
            "Аудит маркетинга",
            "Критерии эффективности",
            "Жизненный цикл маркетинга",
            "Бюджетирование",
            "Матрица БКГ",
            "Анкета КАНО",
            "Бренд",
            "Коэффициент эластичности спроса",
            "Конкурентная разведка",
            "Голубой океан",
            "Оборачиваемость",
            "Инстаграм",
            "Окно Джохари",
            "расчет объема продаж",
            "Производство/расходы",
            "Качество",
            "Логика качества",
            "Стандарты качества",
            "СМК",
            "Ценность/стоимость",
            "Бережливое производство",
            "6 сигм",
            "канбан",
            "Развертывание дома качества",
            "ИУП",
            "Проектное управление",
            "Жизненные циклы",
            "Диаграмма ганта",
            "Контроль, мониторинг",
            "Цикл деминга",
            "Инвестиционный проект",
            "Теория ограничений",
            "SCRUM планирование",
            "Риски",
            "Где помогают, гос поддержка",
            "Где можно взять инвестиции",
            "Критерии отбора",
            "Методы отбора",
            "Экспертиза инвестиции",
            "DUE diligence",
            "Дерево решений",
            "Проект стратегического роста",
            "Матрицы",
            "Риски",
            "О финансах",
            "Система налогообложения",
            "Налоги",
            "Точка безубыточности",
            "Прибыли-убытки",
            "Рентабельность",
            "Ставка дисконтирования",
            "Расчеты NPV",
            "IRR",
            "PI - окупаемость",
            "КЭШ-фло",
            "Задолженность",
            "Финансовая устойчивость",
            "Коэффициенты",
            "Активы",
            "Обороты",
            "Гудвил",
            "Анализ отчета",
            "Основные фин показатели",
            "Дюпоновский анализ",
            "Интегрированный анализ",
            "Кредитная операция",
            "Процессно-ориентированное бюджетирование",
            "Управление рисками",
            "Неопределенность",
            "Матрица вероятности последствия",
            "Анализ чувствительности",
            "Метод Дельфи",
            "Количественный анализ",
            "Роза рисков",
            "Ранжирование рисков",
            "Матрица оценки рисков",
            "Метод GERT",
            "FMEA анализ",
            "Антикризисное управление",
            "Сертификация",
            "ИС - знание-капитал",
            "Интеллектуальные ресурсы компании",
            "Охраняемые результаты ИС",
            "Методика защиты ИС",
            "Коммерциализация разработок",
            "НМА",
            "Оценка",
            "Ценность кадров",
            "Модель организации",
            "KPI",
            "Мотивы работника",
            "Мотивация работника",
            "Критерии работника",
            "Должностная инструкция",
            "Менеджмент",
            "Система сбалансированных показателей",
            "Грейды",
            "Управление по пирамиде Маслоу",
            "Матрица аутсорсинга",
            "Методы оценки эффективности",
            "Стратегическое планирование",
            "Расчет мотивации",
            "Эмоциональный интеллект",
            "Стили мышления",
            "Риски",
            "Виды стратегии",
            "Анализ стратегии",
            "Человек - команда",
            "Призма восприятия",
            "Миссия компании",
            "Ценности компании",
            "Ключевые факторы успеха компании",
            "Три круга ежа - стратегия",
            "Еж/лиса",
            "7 навыков высокой эффективности",
            "Управление временем",
            "Методы мышления",
            "PEST анализ",
            "Анализ заинтересованных сторон",
            "5 сил портера",
            "Конкурентные стратегии Портера",
            "Матрица ADL",
            "Много матриц",
            "Построение стратегии",
            "Определение",
            "Параллельная многозадачность",
            "Управление бизнес-процессами",
            "Исикава",
            "Бенчмаркинг",
            "Оптимизация бизнес-процессов",
            "Аутсорсинг",
            "Презентация: Выбор идеи",
            "Презентация: Анализ идеи",
            "Презентация: Продажа",
            "Презентация: Производство",
            "Презентация: План",
            "Презентация: Инвестиции",
            "Презентация: Финансы",
            "Презентация: Риски",
            "Презентация: Защита инфо",
            "Презентация: Кадры",
            "Презентация: Стратегия",
            "Презентация: Бизнес-процессы",
        ];

        $stylesheet = "body { background-color: #d9eef0; }";
        date_default_timezone_set('Asia/Yakutsk');

        foreach ($modules as $module) {
            $time = date('His');
            $slug = Str::slug($module, '_');
            $path = "/tmp/pdf/{$time}_{$slug}.pdf";
            $html = "<h1>$module</h1>";

            $mpdf = new \Mpdf\Mpdf(['orientation' => 'L']);
            $mpdf->WriteHTML($stylesheet, \Mpdf\HTMLParserMode::HEADER_CSS);
            $mpdf->WriteHTML($html, \Mpdf\HTMLParserMode::HTML_BODY);
            $mpdf->Output($path, \Mpdf\Output\Destination::FILE);

            $output->writeln("<info>$path</info>");
            usleep(100000);
        }

        return Command::SUCCESS;
    }
}